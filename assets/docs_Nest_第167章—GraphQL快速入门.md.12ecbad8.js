import{_ as s,v as n,b as a,R as p}from"./chunks/framework.eb2f4134.js";const i=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"docs/Nest/ç¬¬167ç« â€”GraphQLå¿«é€Ÿå…¥é—¨.md","filePath":"docs/Nest/ç¬¬167ç« â€”GraphQLå¿«é€Ÿå…¥é—¨.md"}'),l={name:"docs/Nest/ç¬¬167ç« â€”GraphQLå¿«é€Ÿå…¥é—¨.md"},o=p(`<p>ä½œä¸ºå‰ç«¯å¼€å‘ï¼Œæƒ³å¿…ç»å¸¸åšçš„äº‹æƒ…å°±æ˜¯ï¼šè°ƒæ¥å£ã€ç”»é¡µé¢ã€è°ƒæ¥å£ã€ç”»é¡µé¢...</p><p>è°ƒç”¨çš„æ¥å£å¤§æ¦‚ç‡æ˜¯ restful çš„ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼è¿™ç§ï¼š</p><p>/students æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯</p><p>/student/1 æŸ¥è¯¢ id ä¸º 1 çš„å­¦ç”Ÿä¿¡æ¯</p><p>ä¸Šé¢è¯´çš„æ˜¯ get è¯·æ±‚ã€‚</p><p>å¦‚æœå¯¹ /student/1 å‘é€ POSTã€PUTã€DELETE è¯·æ±‚ï¼Œå°±åˆ†åˆ«ä»£è¡¨äº†æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ã€‚</p><p>è¿™å°±æ˜¯ restful é£æ ¼çš„ web æ¥å£ã€‚</p><p>è¿™ç§æ¥å£è¿”å›ä»€ä¹ˆä¿¡æ¯æ˜¯æœåŠ¡ç«¯é‚£è¾¹å†³å®šçš„ï¼Œå®¢æˆ·ç«¯åªæ˜¯ä¼ ä¸€ä¸‹å‚æ•°ã€‚</p><p>è€Œä¸åŒåœºæ™¯ä¸‹éœ€è¦çš„æ•°æ®ä¸åŒï¼Œè¿™æ—¶å€™å¯èƒ½å°±å¾—æ–°å¼€å‘ä¸€ä¸ªæ¥å£ã€‚ç‰¹åˆ«æ˜¯åœ¨ç‰ˆæœ¬æ›´æ–°çš„æ—¶å€™ï¼Œæ¥å£ä¼šæœ‰æ‰€å˜åŠ¨ã€‚</p><p>è¿™æ ·å°±å¾ˆå®¹æ˜“å¯¼è‡´ä¸€å¤§å †ç±»ä¼¼çš„æ¥å£ã€‚</p><p>facebook å½“æ—¶ä¹Ÿé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯ä»–ä»¬åˆ›é€ äº†ä¸€ç§æ–°çš„æ¥å£å®ç°æ–¹æ¡ˆï¼šGraphQLã€‚</p><p>ç”¨äº† GraphQL ä¹‹åï¼Œè¿”å›ä»€ä¹ˆæ•°æ®ä¸å†æ˜¯æœåŠ¡ç«¯è¯´äº†ç®—ï¼Œè€Œæ˜¯å®¢æˆ·ç«¯è‡ªå·±å†³å®šã€‚</p><p>æœåŠ¡ç«¯åªéœ€è¦æä¾›ä¸€ä¸ªæ¥å£ï¼Œå®¢æˆ·ç«¯é€šè¿‡è¿™ä¸ªæ¥å£å°±å¯ä»¥å–ä»»æ„æ ¼å¼çš„æ•°æ®ï¼Œå®ç° CRUDã€‚</p><p>æ¯”å¦‚æƒ³æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿï¼Œå°±å¯ä»¥è¿™æ ·ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -1.png" alt=""></p><p>æƒ³å†æŸ¥è¯¢ä»–ä»¬çš„å¹´é¾„ï¼Œå°±å¯ä»¥è¿™æ ·ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -2.png" alt=""></p><p>æƒ³æŸ¥è¯¢è€å¸ˆçš„åå­—å’Œä»–æ•™çš„å­¦ç”Ÿï¼Œå°±å¯ä»¥è¿™æ ·ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -3.png" alt=""></p><p>è€Œè¿™äº›éƒ½æ˜¯åœ¨ä¸€ä¸ª http æ¥å£é‡Œå®Œæˆçš„ï¼</p><p>æ„Ÿå—äº† GraphQL çš„å¥½å¤„äº†æ²¡ï¼Ÿ</p><p><strong>ä¸€ä¸ª http æ¥å£å°±èƒ½å®ç°æ‰€æœ‰çš„ CRUDï¼</strong></p><p>é‚£è¿™ä¹ˆå¼ºå¤§çš„ GraphQL æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆå†™ä¸ª demo å¿«é€Ÿå…¥é—¨ä¸€ä¸‹ï¼š</p><p>facebook æä¾›äº† graphql çš„ npm åŒ…ï¼Œä½†é‚£ä¸ªå°è£…çš„ä¸å¤Ÿå¥½ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šç”¨åŸºäº graphql åŒ…çš„ @apollo/server å’Œ @apollo/client çš„åŒ…æ¥å®ç° graphqlã€‚</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mkdir graphql-crud-demo</span></span>
<span class="line"><span style="color:#A6ACCD;">cd graphql-crud-demo</span></span>
<span class="line"><span style="color:#A6ACCD;">npm init -y</span></span></code></pre></div><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -4.png" alt=""></p><p>å®‰è£…ç”¨åˆ°çš„åŒ…ï¼š</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install @apollo/server</span></span></code></pre></div><p>ç„¶ååœ¨ index.js å†™ä¸€ä¸‹è¿™æ®µä»£ç ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ApolloServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@apollo/server</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> typeDefs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">  type Student {</span></span>
<span class="line"><span style="color:#C3E88D;">    id: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    name: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    sex: Boolean</span></span>
<span class="line"><span style="color:#C3E88D;">    age: Int</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Teacher {</span></span>
<span class="line"><span style="color:#C3E88D;">    id: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    name: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    age: Int,</span></span>
<span class="line"><span style="color:#C3E88D;">    subject: [String],</span></span>
<span class="line"><span style="color:#C3E88D;">    students: [Student]</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Query {</span></span>
<span class="line"><span style="color:#C3E88D;">    students: [Student],</span></span>
<span class="line"><span style="color:#C3E88D;">    teachers: [Teacher],</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  schema {</span></span>
<span class="line"><span style="color:#C3E88D;">    query: Query</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>æ¯”è¾ƒå®¹æ˜“çœ‹æ‡‚ï¼Œå®šä¹‰äº†ä¸€ä¸ª Student çš„å¯¹è±¡ç±»å‹ï¼Œæœ‰ idã€nameã€sexã€age è¿™å‡ ä¸ªå­—æ®µã€‚</p><p>åˆå®šä¹‰äº†ä¸€ä¸ª Teacher çš„å¯¹è±¡ç±»å‹ï¼Œæœ‰ idã€nameã€ageã€subjectã€students è¿™å‡ ä¸ªå­—æ®µã€‚students å­—æ®µæ˜¯ä»–æ•™çš„å­¦ç”Ÿçš„ä¿¡æ¯ã€‚</p><p>ç„¶åå®šä¹‰äº†æŸ¥è¯¢çš„å…¥å£ï¼Œå¯ä»¥æŸ¥ students å’Œ teachers çš„ä¿¡æ¯ã€‚</p><p>è¿™æ ·å°±æ˜¯ä¸€ä¸ª schemaã€‚</p><p>å¯¹è±¡ç±»å‹å’Œå¯¹è±¡ç±»å‹ä¹‹é—´æœ‰å…³è”å…³ç³»ï¼Œè€å¸ˆå…³è”äº†å­¦ç”Ÿã€å­¦ç”Ÿä¹Ÿå¯ä»¥å…³è”è€å¸ˆï¼Œå…³è”æ¥å…³è”å»è¿™ä¸å°±æ˜¯ä¸€ä¸ªå›¾ä¹ˆï¼Œä¹Ÿå°±æ˜¯ graphã€‚</p><p>GraphQL å…¨ç§°æ˜¯ graph query languageï¼Œå°±æ˜¯ä»è¿™ä¸ªå¯¹è±¡çš„ graph ä¸­æŸ¥è¯¢æ•°æ®çš„ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å£°æ˜çš„åªæ˜¯å¯¹è±¡ç±»å‹çš„å…³ç³»ï¼Œè¿˜è¦çŸ¥é“è¿™äº›ç±»å‹çš„å…·ä½“æ•°æ®ï¼Œå–æ•°æ®çš„è¿™éƒ¨åˆ†å«åš resolverã€‚</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> students </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å–æ•°æ®</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å…‰å…‰</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä¸œä¸œ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">13</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å°çº¢</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">11</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> teachers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¥å…‰</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">subject</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä½“è‚²</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ•°å­¦</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">28</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> students</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> resolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Query</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> students</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">teachers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> teachers</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>resolver æ˜¯å–å¯¹è±¡ç±»å‹å¯¹åº”çš„æ•°æ®çš„ï¼Œæ¯ä¸ªå­—æ®µéƒ½å¯ä»¥å†™ä¸€ä¸ª async å‡½æ•°ï¼Œé‡Œé¢æ‰§è¡Œ sqlã€è®¿é—®æ¥å£ç­‰éƒ½å¯ä»¥ï¼Œæœ€ç»ˆè¿”å›å–åˆ°çš„æ•°æ®ã€‚</p><p>å½“ç„¶ï¼Œç›´æ¥å†™å…·ä½“çš„æ•°æ®ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>è¿™æ ·æœ‰äº† schema ç±»å‹å®šä¹‰ï¼Œæœ‰äº†å–æ•°æ®çš„ resovlerï¼Œå°±å¯ä»¥è·‘èµ· graphql æœåŠ¡äº†ã€‚</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -5.png" alt=""></p><p>ä¹Ÿå°±æ˜¯è¿™æ ·ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">startStandaloneServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@apollo/server/standalone</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ApolloServer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    typeDefs</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    resolvers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">startStandaloneServer</span><span style="color:#A6ACCD;">(server</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">listen</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">ğŸš€  Server ready at: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">}\`</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>ä¼ å…¥ schema ç±»å‹å®šä¹‰å’Œå–æ•°æ®çš„ resolverï¼Œå°±å¯ä»¥ç”¨ node æŠŠæœåŠ¡è·‘èµ·æ¥ã€‚</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -6.png" alt=""></p><p>æœ‰åŒå­¦å¯èƒ½é—®äº†ï¼Œnode å¯ä»¥ç›´æ¥è§£æ esm æ¨¡å—ä¹ˆï¼Ÿ</p><p>å¯ä»¥çš„ã€‚åªéœ€è¦åœ¨ package.json ä¸­å£°æ˜ type ä¸º moduleï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -7.png" alt=""></p><p>é‚£æ‰€æœ‰çš„ .js å°±éƒ½ä¼šä½œä¸º esm æ¨¡å—è§£æï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -8.png" alt=""></p><p>è·‘èµ·æ¥ä¹‹åï¼Œæµè§ˆå™¨è®¿é—®ä¸€ä¸‹ï¼š</p><p>å°±å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ sandboxï¼Œè¿™é‡Œå¯ä»¥æ‰§è¡Œ graphql çš„æŸ¥è¯¢ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -9.png" alt=""></p><p>ï¼ˆgraphql æ¥å£æ˜¯ç›‘å¬ POST è¯·æ±‚çš„ï¼Œç”¨ get è¯·æ±‚è¿™ä¸ª url æ‰ä¼šè·‘è¿™ä¸ªè°ƒè¯•çš„å·¥å…·ï¼‰</p><p>æˆ‘æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿçš„ idã€nameã€age å°±å¯ä»¥è¿™æ ·ï¼š</p><div class="language-graphql"><button title="Copy Code" class="copy"></button><span class="lang">graphql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">query</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Query</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    students </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        name</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -10.png" alt=""></p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -11.png" alt=""></p><p>è¿™é‡Œ â€œå…‰å…‰â€ é‚£ä¸ªå­¦ç”Ÿæ˜¯å¼‚æ­¥å–çš„æ•°æ®ï¼Œresolver ä¼šæ‰§è¡Œå¯¹åº”çš„å¼‚æ­¥å‡½æ•°ï¼Œæ‹¿åˆ°æœ€ç»ˆæ•°æ®ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -12.png" alt=""></p><p>å–è€å¸ˆçš„ä¿¡æ¯å°±å¯ä»¥è¿™æ ·ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -13.png" alt=""></p><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ª graphql æ¥å£ï¼</p><p>æ„Ÿè§‰åˆ°ä»€ä¹ˆå«å®¢æˆ·ç«¯å†³å®šå–ä»€ä¹ˆæ•°æ®äº†ä¹ˆï¼Ÿ</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯åœ¨ sandbox é‡Œæµ‹çš„ï¼Œç”¨ @apollo/client åŒ…ä¹Ÿå¾ˆç®€å•ã€‚</p><p>æ¯”å¦‚ react çš„ graphql å®¢æˆ·ç«¯æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -14.png" alt=""></p><p>ä¸€ä¸ª gql çš„ api æ¥å†™æŸ¥è¯¢è¯­è¨€ï¼Œä¸€ä¸ª useQuery çš„ api æ¥æ‰§è¡ŒæŸ¥è¯¢ã€‚</p><p>å­¦èµ·æ¥å¾ˆç®€å•ã€‚</p><p>æˆ‘ä»¬ä¹‹åè¿˜æ˜¯ç›´æ¥åœ¨ sandbox é‡Œæµ‹è¯•ã€‚</p><p>æœ‰çš„åŒå­¦å¯èƒ½ä¼šè¯´ï¼Œå¦‚æœæˆ‘æƒ³æŸ¥è¯¢æŸä¸ªåå­—çš„è€å¸ˆçš„ä¿¡æ¯å‘¢ï¼Ÿ</p><p>æ€ä¹ˆä¼ å‚æ•°ï¼Ÿ</p><p>graphql å½“ç„¶æ˜¯æ”¯æŒçš„ï¼Œè¿™æ ·å†™ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -15.png" alt=""></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">type Query {</span></span>
<span class="line"><span style="color:#A6ACCD;">    students: [Student],</span></span>
<span class="line"><span style="color:#A6ACCD;">    teachers: [Teacher],</span></span>
<span class="line"><span style="color:#A6ACCD;">    studentsbyTeacherName(name: String!): [Student]</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>æ–°åŠ ä¸€ä¸ª query å…¥å£ï¼Œå£°æ˜ä¸€ä¸ª name çš„å‚æ•°ã€‚ï¼ˆè¿™é‡Œ String åçš„ ! ä»£è¡¨ä¸èƒ½ä¸ºç©ºï¼‰</p><p>ç„¶åå®ƒå¯¹åº”çš„ resolver å°±æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -16.png" alt=""></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> resolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Query</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> students</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">teachers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> teachers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">studentsbyTeacherName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ‰§è¡Œäº†ä¸€ä¸ªå¼‚æ­¥æŸ¥è¯¢</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">students</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>studentsbyTeacherName å­—æ®µçš„ resolver æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œé‡Œé¢æ‰§è¡Œäº†æŸ¥è¯¢ï¼Œç„¶åè¿”å›äº†æŸ¥åˆ°çš„å­¦ç”Ÿä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬æ‰“å°ä¸‹å‚æ•°çœ‹çœ‹ä¼ è¿‡æ¥çš„æ˜¯ä»€ä¹ˆã€‚</p><p>æœ‰å‚æ•°çš„æŸ¥è¯¢æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -17.png" alt=""></p><p>ä¼ å…¥è€å¸ˆçš„ name å‚æ•°ä¸º 111ï¼Œè¿”å›æŸ¥åˆ°çš„å­¦ç”Ÿçš„ idã€name ä¿¡æ¯ã€‚</p><p>å¯ä»¥çœ‹åˆ°è¿”å›çš„å°±æ˜¯æŸ¥è¯¢åˆ°çš„ç»“æœã€‚</p><p>è€ŒæœåŠ¡ç«¯çš„ resolver æ¥æ”¶åˆ°çš„å‚æ•°æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -18.png" alt=""></p><p>å…¶ä½™çš„å‡ ä¸ªå‚æ•°ä¸ç”¨ç®¡ï¼Œåªè¦çŸ¥é“ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„æŸ¥è¯¢å‚æ•°å°±å¥½äº†ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ª name å‚æ•°å®ç°å¼‚æ­¥çš„æŸ¥è¯¢ï¼Œç„¶åè¿”å›æ•°æ®ã€‚</p><p>è¿™å°±å®ç°äº†æœ‰å‚æ•°çš„æŸ¥è¯¢ã€‚</p><p>ä¸æ˜¯è¯´ graphql èƒ½å–ä»£ restful åš CRUD ä¹ˆï¼Ÿé‚£å¢åˆ æ”¹æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>å…¶å®çœ‹åˆ°ä¸Šé¢çš„æœ‰å‚æ•°çš„æŸ¥è¯¢åº”è¯¥å°±èƒ½æƒ³åˆ°äº†ï¼Œå…¶å®å†™èµ·æ¥å·®ä¸å¤šã€‚</p><p>åœ¨ schema é‡Œæ·»åŠ è¿™æ ·ä¸€æ®µç±»å‹å®šä¹‰ï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -19.png" alt=""></p><div class="language-grqphql"><button title="Copy Code" class="copy"></button><span class="lang">grqphql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">type Res {</span></span>
<span class="line"><span style="color:#A6ACCD;">    success: Boolean</span></span>
<span class="line"><span style="color:#A6ACCD;">    id: String</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">type Mutation {</span></span>
<span class="line"><span style="color:#A6ACCD;">    addStudent(name:String! age:Int! sex:Boolean!): Res</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    updateStudent(id: String! name:String! age:Int! sex:Boolean!): Res</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    deleteStudent(id: String!): Res</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">schema {</span></span>
<span class="line"><span style="color:#A6ACCD;">    mutation: Mutation</span></span>
<span class="line"><span style="color:#A6ACCD;">    query: Query</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>å’Œæœ‰å‚æ•°çš„æŸ¥è¯¢å·®ä¸å¤šï¼Œåªä¸è¿‡è¿™éƒ¨åˆ†å¢åˆ æ”¹çš„ç±»å‹è¦å®šä¹‰åœ¨ mutation éƒ¨åˆ†ã€‚</p><p>ç„¶å resolver ä¹Ÿè¦æœ‰å¯¹åº”çš„å®ç°ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">addStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">age</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">sex</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">students</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä¸€ä¸ªéšæœº id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">age</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">sex</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">updateStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">age</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">sex</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">deleteStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> resolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Query</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> students</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">teachers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> teachers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">studentsbyTeacherName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ‰§è¡Œäº†ä¸€ä¸ªå¼‚æ­¥æŸ¥è¯¢</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">students</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Mutation</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">addStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> addStudent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">updateStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> updateStudent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">deleteStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> deleteStudent</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><p>å’Œ query éƒ¨åˆ†å·®ä¸å¤šï¼Œåªä¸è¿‡è¿™é‡Œå®ç°çš„æ˜¯å¢åˆ æ”¹ã€‚</p><p>æˆ‘åªå¯¹ addStudent åšäº†å®ç°ã€‚</p><p>æˆ‘ä»¬æµ‹è¯•ä¸‹ï¼š</p><p>æ‰§è¡Œ addStudentï¼Œæ·»åŠ ä¸€ä¸ªå­¦ç”Ÿï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -20.png" alt=""></p><p>ç„¶åå†æ¬¡æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿï¼š</p><p><img src="//liushuaiyang.oss-cn-shanghai.aliyuncs.com/nest-docs/image/ç¬¬167ç« -21.png" alt=""></p><p>å°±å¯ä»¥æŸ¥åˆ°åˆšæ¥çš„å°åˆšåŒå­¦ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸€ä¸ª graphql çš„ POST æ¥å£é‡Œå®Œæˆæ‰€æœ‰çš„ CRUDï¼</p><p>å…¨éƒ¨ä»£ç å¦‚ä¸‹ï¼Œå¤§å®¶å¯ä»¥è·‘ä¸€è·‘ï¼ˆæ³¨æ„è¦åœ¨ package.json é‡ŒåŠ ä¸ª type: &quot;module&quot;ï¼‰</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ApolloServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@apollo/server</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">startStandaloneServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@apollo/server/standalone</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> typeDefs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#C3E88D;">  type Student {</span></span>
<span class="line"><span style="color:#C3E88D;">    id: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    name: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    sex: Boolean</span></span>
<span class="line"><span style="color:#C3E88D;">    age: Int</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Teacher {</span></span>
<span class="line"><span style="color:#C3E88D;">    id: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    name: String,</span></span>
<span class="line"><span style="color:#C3E88D;">    age: Int,</span></span>
<span class="line"><span style="color:#C3E88D;">    subject: [String],</span></span>
<span class="line"><span style="color:#C3E88D;">    students: [Student]</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Query {</span></span>
<span class="line"><span style="color:#C3E88D;">    students: [Student],</span></span>
<span class="line"><span style="color:#C3E88D;">    teachers: [Teacher],</span></span>
<span class="line"><span style="color:#C3E88D;">    studentsbyTeacherName(name: String!): [Student]</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Res {</span></span>
<span class="line"><span style="color:#C3E88D;">    success: Boolean</span></span>
<span class="line"><span style="color:#C3E88D;">    id: String</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  type Mutation {</span></span>
<span class="line"><span style="color:#C3E88D;">    addStudent(name:String! age:Int! sex:Boolean!): Res</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">    updateStudent(id: String! name:String! age:Int! sex:Boolean!): Res</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">    deleteStudent(id: String!): Res</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">  schema {</span></span>
<span class="line"><span style="color:#C3E88D;">    mutation: Mutation</span></span>
<span class="line"><span style="color:#C3E88D;">    query: Query</span></span>
<span class="line"><span style="color:#C3E88D;">  }</span></span>
<span class="line"><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> students </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å–æ•°æ®</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å…‰å…‰</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä¸œä¸œ</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">13</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">å°çº¢</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">11</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> teachers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ç¥å…‰</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">sex</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">subject</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä½“è‚²</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ•°å­¦</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">28</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> students</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">addStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">age</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">sex</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">students</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ä¸€ä¸ªéšæœº id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">age</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">sex</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">updateStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">age</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">sex</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">deleteStudent</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      id</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> resolvers </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Query</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">students</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> students</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">teachers</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> teachers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">studentsbyTeacherName</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">æ‰§è¡Œäº†ä¸€ä¸ªå¼‚æ­¥æŸ¥è¯¢</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">students</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">Mutation</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">addStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> addStudent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">updateStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> updateStudent</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">deleteStudent</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> deleteStudent</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ApolloServer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    typeDefs</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    resolvers</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">startStandaloneServer</span><span style="color:#A6ACCD;">(server</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">listen</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">ğŸš€  Server ready at: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">}\`</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>å®Œæˆäº† graphql çš„å…¥é—¨ï¼Œæˆ‘ä»¬å†ç¨å¾®æ€è€ƒä¸‹å®ƒçš„åŸç†ã€‚graphql æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p><p>å›é¡¾æ•´ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬å‘ç°æ¶‰åŠåˆ°ä¸¤ç§ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰ï¼Œä¸€ä¸ªæ˜¯ schema å®šä¹‰çš„ DSLï¼Œä¸€ä¸ªæ˜¯æŸ¥è¯¢çš„ DSLã€‚</p><p>æœåŠ¡ç«¯é€šè¿‡ schema å®šä¹‰çš„ DSL æ¥å£°æ˜ graph å›¾ï¼Œé€šè¿‡ resolver æ¥æ¥å—å‚æ•°ï¼Œæ‰§è¡ŒæŸ¥è¯¢å’Œå¢åˆ æ”¹ã€‚</p><p>å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢çš„ DSL æ¥å®šä¹‰å¦‚ä½•æŸ¥è¯¢å’Œå¦‚ä½•å¢åˆ æ”¹ï¼Œå†å‘ç»™æœåŠ¡ç«¯æ¥è§£ææ‰§è¡Œã€‚</p><p>é€šè¿‡è¿™ç§ DSL å®ç°äº†åŠ¨æ€çš„æŸ¥è¯¢ã€‚</p><p>ç¡®å®å¾ˆæ–¹ä¾¿å¾ˆçµæ´»ï¼Œä½†ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå°±æ˜¯ parse DSL ä¸º AST æ€§èƒ½è‚¯å®šæ˜¯ä¸å¦‚ restful é‚£ç§ç›´æ¥æ‰§è¡Œå¢åˆ æ”¹æŸ¥é«˜çš„ã€‚</p><p>å…·ä½“è¦ä¸è¦ç”¨ graphql è¿˜æ˜¯è¦æ ¹æ®å…·ä½“åœºæ™¯æ¥åšåˆ¤æ–­ã€‚</p><p>æ¡ˆä¾‹ä»£ç åœ¨<a href="https://github.com/QuarkGluonPlasma/nestjs-course-code/tree/main/graphql-crud-demo" target="_blank" rel="noreferrer">å°å†Œä»“åº“</a>ã€‚</p><h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">â€‹</a></h2><p>restful æ¥å£æ˜¯ url ä»£è¡¨èµ„æºï¼ŒGETã€POSTã€PUTã€DELETE è¯·æ±‚ä»£è¡¨å¯¹èµ„æºçš„å¢åˆ æ”¹æŸ¥ã€‚</p><p>è¿™ç§æ¥å£è¿”å›ä»€ä¹ˆæ•°æ®å®Œå…¨ç”±æœåŠ¡ç«¯å†³å®šï¼Œæ¯æ¬¡æ¥å£å˜åŠ¨å¯èƒ½å°±å¾—æ–°åŠ ä¸€ç§æ¥å£ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œfacebook åˆ›é€ äº† graphqlï¼Œè¿™ç§æ¥å£è¿”å›ä»€ä¹ˆæ•°æ®å®Œå…¨ç”±å®¢æˆ·ç«¯å†³å®šã€‚å¢åˆ æ”¹æŸ¥é€šè¿‡è¿™ä¸€ä¸ªæ¥å£å°±å¯ä»¥æå®šã€‚</p><p>graphql éœ€è¦åœ¨æœåŠ¡ç«¯å®šä¹‰ schemaï¼Œä¹Ÿå°±æ˜¯å®šä¹‰å¯¹è±¡ç±»å‹å’Œå®ƒçš„å­—æ®µï¼Œå¯¹è±¡ç±»å‹å’Œå¯¹è±¡ç±»å‹ä¹‹é—´ä¼šæœ‰å…³è”ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª graphï¼ŒæŸ¥è¯¢å°±æ˜¯ä»è¿™ä¸ª graph é‡ŒæŸ¥è¯¢æ•°æ®ã€‚</p><p>é™¤äº† schema å¤–ï¼Œè¿˜éœ€è¦æœ‰ resolverï¼Œå®ƒè´Ÿè´£æ¥å—å®¢æˆ·ç«¯çš„å‚æ•°ï¼Œå®Œæˆå…·ä½“æ•°æ®çš„å¢åˆ æ”¹æŸ¥ã€‚</p><p>graphql ä¼šæš´éœ²ä¸€ä¸ª post æ¥å£ï¼Œé€šè¿‡æŸ¥è¯¢è¯­è¨€çš„è¯­æ³•å°±å¯ä»¥ä»é€šè¿‡è¿™ä¸ªæ¥å£å®Œæˆæ‰€æœ‰å¢åˆ æ”¹æŸ¥ã€‚</p><p>æœ¬åœ°æµ‹è¯•çš„æ—¶å€™ï¼Œget è¯·æ±‚ä¼šè·‘ä¸€ä¸ª sandboxï¼Œå¯ä»¥åœ¨è¿™é‡Œæµ‹è¯•æ¥å£ã€‚</p><p>æ•´ä¸ªæµç¨‹æ¶‰åŠåˆ°ä¸¤ç§æ–°è¯­è¨€ï¼š schema å®šä¹‰è¯­è¨€å’Œ query æŸ¥è¯¢è¯­è¨€ã€‚å…¥é—¨ä¹‹åå‘æ·±å…¥çš„è¯å°±æ˜¯è¦å­¦ä¸‹è¿™ä¸¤ç§ DSL çš„æ›´å¤šè¯­æ³•ã€‚</p><p>æ„Ÿå—åˆ° graphql çš„å¼ºå¤§ä¹‹å¤„äº†ä¹ˆï¼Ÿä¸€ä¸ªæ¥å£å°±å¯ä»¥å®ç°æ‰€æœ‰çš„ CRUDï¼</p>`,129),e=[o];function t(c,r,D,y,F,C){return n(),a("div",null,e)}const u=s(l,[["render",t]]);export{i as __pageData,u as default};
